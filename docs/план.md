## План приложения

### SERVER — внешний сервер  
- Любой источник данных (MQTT, HTTP).  
- В нашем случае — Home Assistant с MQTT.  
- Отвечает за получение и отправку сообщений о состоянии устройств.

### STATE — единое хранилище данных и состояния  
- Хранит текущее состояние всех датчиков и переключателей.  
- Содержит структуру `EntityState` для значений и общий список сущностей `EntityCfg`.  
- Отдельно хранится состояние интерфейса (текущий экран, активность и т.п.).  
- Все изменения проходят через этот слой.

### UI — визуализация состояния  
- Отдельные экраны и режим скринсейвера.  
- Отображает данные из STATE, не зная, откуда они пришли.  
- Подписывается на обновления через встроенный механизм `lv_msg`.  
- Реагирует на изменения данных и пользовательский ввод.

### ROUTER — связующий слой (медиатор)  
- Соединяет SERVER, STATE и UI.  
- Получает сообщения от SERVER и обновляет STATE.  
- Передаёт команды пользователя (toggle, set) из UI обратно на SERVER.  
- Следит за подписками, реконнектами и синхронизацией данных.
